// Test program that demonstrates the new interface with effect return values
args => {
  // args[0] is the state, args[1] is the return value (if any)
  estado: args[0] || "default"
  retorno: args[1]
  
  // If this is the first call (no return value), start with initial effects
  retorno == null ? {
    efeitos: {
      {1 "Starting stateful program"}
      "Math.pow(2, 3)"  // This will return 8
    }
    novo_estado: "initial_state"
    {efeitos novo_estado}
  }[0] :
  // If we have a return value, use it to generate new effects
  {
    efeitos: {
      {1 {"Received return value: " "" + retorno} * ""}
      estado == "initial_state" ? 
        "Math.sqrt(16)" :  // This will return 4
        {1 {"Final result: " "" + retorno} * ""}
      {0 0}
    }
    novo_estado: estado == "initial_state" ? "second_state" : "final_state"
    {efeitos novo_estado}
  }[0]
}